function AppController(t){}function FrontController(t){t.patients=[],t.underline_word=function(e){var n=new RegExp(t.patient,"gi"),r=e.replace(n,"<strong>$&</strong>");return $sce.trustAsHtml(r)},t.search_pacients=function(){return""==t.patient?void(t.patients=[]):void $http({method:"POST",url:base_url+"/pacients/s/"+t.patient}).then(function(e){t.patients=e.data},function(t){console.log(t)})},t.show_birthdays=function(t){var e=$(t.target),n=e.attr("data-json")?JSON.parse(e.attr("data-json")):JSON.parse(e.parent().attr("data-json"));if(0!==Object.keys(n).length&&JSON.stringify(n)!==JSON.stringify({})){var r=$("<div>",{"class":"tooltip tooltip-"+(new Date).getTime()});r.css({position:"absolute",top:e.offset().top+20+"px",left:e.offset().left+"px"});for(var o in n)r.append("<p>El pacient "+n[o].full_name+" compleix anys el dia "+n[o].date+"</p>");$("body").append(r)}},t.delete_tooltip=function(){$(".tooltip").remove()}}function UsersController(t,e){t.user={},t.randomStr=function(t){for(var t=t||9,e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;t>r;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},t.showDeleteModal=function(t){t.preventDefault();var e=$(t.target).parent().attr("href"),n=confirm("Estàs segur d'eliminar aquest usuari?");n&&(window.location.href=e)},document.querySelector(".user_json")&&(t.user=JSON.parse(document.querySelector(".user_json").innerHTML),t.user.blocked=1==t.user.blocked,t.user.password=t.randomStr(16),console.log(t.user))}function PacientsController(t,e,n,r){t.pacient={},t.search="",t.patients=[],document.querySelector(".pacient_json")&&(t.pacient=JSON.parse(document.querySelector(".pacient_json").innerHTML),t.pacient.birth_date="undefined"!=typeof t.pacient.birth_date?e("date")(new Date(t.pacient.birth_date),"dd/MM/y"):"",t.pacient.age="undefined"!=typeof t.pacient.age?parseInt(t.pacient.age):""),t.putAgeFromDate=function(e){var n=/^\d{2}([./-])\d{2}\1\d{4}$/;if(e.match(n)){var r=e.split("/"),o=new Date(r[2],r[1]-1,r[0]),i=Date.now()-o.getTime(),a=new Date(i);t.pacient.age=Math.abs(a.getUTCFullYear()-1970)}else console.log("nop!")},t.showDeleteModal=function(t){t.preventDefault();var e=$(t.target).parent().attr("href"),n=confirm("Estàs segur d'eliminar aquest pacient?");n&&(window.location.href=e)},t.search_pacient=function(e){t.locationUrl=t.location+t.search.term,n({method:"POST",url:t.locationUrl}).then(function(e){t.patients=e.data},function(t){console.log(t)})},t.underline_word=function(e){var n=new RegExp(t.search.term,"gi"),o=e.replace(n,"<strong>$&</strong>");return r.trustAsHtml(o)}}function FlashController(t,e){t.timeOut=!1,e(function(){t.timeOut=!0},3e3)}function ReviewController(t,e,n,r){t.data=new Date,t.actualDate=new Date,t.form={},t.review=[],t.dates=[],""!=$("#review").val()&&(t.review=JSON.parse($("#review").val())),t.addDateToReview=function(n){n.preventDefault();for(var r=null,o=0;o<t.review.length;o++)if(t.isToday(t.review[o].id)){r=t.review[o];break}for(var o=0;o<t.dates.length;o++)if(t.isToday(t.dates[o].id)){r=t.dates[o];break}if(null===r){var i=new Date;t.dates.push({date:e("date")(i,"dd MMM yyyy HH:mm"),text:"",id:i.getTime()})}else t.animate=!0,t.editDateReview(r,!0)},t.submitForm=function(e){var n=t.review;n=n.concat(t.dates);var r=JSON.stringify(n);$("#review").val(r)},t.showActualHour=function(){t.actualDate=e("date")(new Date,"dd MMM yyyy HH:m")},t.isToday=function(t){return!0},t.editDateReview=function(e,r){r=r||!1,r||(t.animate=!1),t.edit=e.id,n(function(){t.animate=!1},500)},t.checkKey=function(t){},t.showReview=function(t){},t.print=function(){r.print()}}function BillController(t,e,n,r,o,i){t.bill={qty:0,price_per_unit:0,discount:0,iva:0,irpf:0,total_bill:0,total_partial:0,amount_irpf:0,total:0,amount_discount:0},t.billInfo={},t.urlBillInfo="",t.clients={},t.pacients=[],t.client={},t.patient={},t.autocomplete=!1,t.widthSearchInput="100px",t.searchUrl="",t.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var n,r,o,i,a,l,c,u="",s=0;for(e=t.Base64._utf8_encode(e);s<e.length;)n=e.charCodeAt(s++),r=e.charCodeAt(s++),o=e.charCodeAt(s++),i=n>>2,a=(3&n)<<4|r>>4,l=(15&r)<<2|o>>6,c=63&o,isNaN(r)?l=c=64:isNaN(o)&&(c=64),u=u+this._keyStr.charAt(i)+this._keyStr.charAt(a)+this._keyStr.charAt(l)+this._keyStr.charAt(c);return u},decode:function(e){var n,r,o,i,a,l,c,u="",s=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");s<e.length;)i=this._keyStr.indexOf(e.charAt(s++)),a=this._keyStr.indexOf(e.charAt(s++)),l=this._keyStr.indexOf(e.charAt(s++)),c=this._keyStr.indexOf(e.charAt(s++)),n=i<<2|a>>4,r=(15&a)<<4|l>>2,o=(3&l)<<6|c,u+=String.fromCharCode(n),64!=l&&(u+=String.fromCharCode(r)),64!=c&&(u+=String.fromCharCode(o));return u=t.Base64._utf8_decode(u)},_utf8_encode:function(t){t=t.replace(/rn/g,"n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);128>r?e+=String.fromCharCode(r):r>127&&2048>r?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e},_utf8_decode:function(t){for(var e="",n=0,r=c1=c2=0;n<t.length;)r=t.charCodeAt(n),128>r?(e+=String.fromCharCode(r),n++):r>191&&224>r?(c2=t.charCodeAt(n+1),e+=String.fromCharCode((31&r)<<6|63&c2),n+=2):(c2=t.charCodeAt(n+1),c3=t.charCodeAt(n+2),e+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),n+=3);return e}},angular.element(i).bind("resize",function(){var e=$('input[name="client_name"]').parent();t.widthSearchInput=e.outerWidth()+20+"px"}),n(function(){var e=$('input[name="client_name"]').parent();t.widthSearchInput=e.outerWidth()+20+"px"},500),t.ask_question=function(t){t.preventDefault();var e=$(t.target).parent(),n=e.attr("href"),r=confirm("Estàs segur que vols eliminar aquesta factura?");r&&(i.location.href=n)},t.today_date=function(){t.bill.date=e("date")(new Date,"dd/MM/y")},t.underline_word=function(e){var n=new RegExp(t.client.name,"gi"),r=e.replace(n,"<strong>$&</strong>");return o.trustAsHtml(r)},t.search_clients_and_patients=function(){return""==t.client.name?void(t.autocomplete=!1):void n(function(){r({method:"POST",url:t.searchUrl+"/"+t.client.name}).then(function(e){t.pacients=e.data.patients,t.clients=e.data.clients,t.clients.length||t.pacients.length?t.autocomplete=!0:t.autocomplete=!1},function(t){console.log(t)})})},t.put_on_bill=function(e,n){"client"==n?(t.client=e,t.bill.client_id=t.client.id,t.bill.patient_id=""):(t.patient=e,t.bill.patient_id=t.patient.id,t.client.name=t.patient.full_name,t.client.address=t.patient.address,t.client.city=t.patient.city,t.client.cif=t.patient.nif,t.bill.client_id=""),t.autocomplete=!1},t.count=function(t){return new Array(t)},t.show_total=function(n,r){return t.bill.total_bill=(isNaN(n)?0:n)-(isNaN(r)?0:r),console.log(t.bill.total_bill),e("currency")(t.bill.total_bill.toFixed(2))},t.show_amount_discount=function(n,r){return t.bill.amount_discount=(isNaN(n)?0:n)*(isNaN(r)?0:r)/100,t.bill.total_partial=t.bill.total-t.bill.amount_discount,e("currency")(t.bill.amount_discount.toFixed(2))},t.show_amount_irpf=function(n,r){return-1!=r.toString().indexOf(",")&&(r=r.toString().replace(",",".")),t.bill.amount_irpf=(isNaN(n)?0:n)*(isNaN(r)?0:r)/100,e("currency")(t.bill.amount_irpf.toFixed(2))},t.autocomplete_id=function(){""!=t.bill.id&&"undefined"!=typeof t.bill.id||(t.bill.id=t.lastId+1)},t.format_date=function(t){var n=t.replace(/-/g,"/");return e("date")(new Date(n),"dd/MM/y")};var a=$("#bill");if(a.length&&"[]"!=a.html().trim()){t.bill=JSON.parse(a.html());var l=t.bill.creation_date.replace(/-/g,"/");t.bill.creation_date=e("date")(new Date(l),"dd/MM/y");var l=t.bill.expiration_date.replace(/-/g,"/");t.bill.expiration_date=e("date")(new Date(l),"dd/MM/y"),""!=t.bill.patient_id&&null!=t.bill.patient_id&&t.put_on_bill(t.bill.patient,"patient"),""!=t.bill.client_id&&null!=t.bill.client_id&&t.put_on_bill(t.bill.client,"client")}}function TestController(t,e,n,r,o,i,a){t.output="",t.days=5,t.daysMail=5,t.title="",t.time=0,t.timeLoader="",t.first_time=!0,t.status=0,t.show_output=function(n,o,i){t.timeLoader="",t.time=0;var l=r(function(){3==t.timeLoader.length&&(t.timeLoader=""),t.timeLoader+="."},100);i=i||null,null!=i&&(n=n+"/"+t[i]),t.title=o,e({method:"GET",url:n}).then(function(e){r.cancel(l),t.output=a.trustAsHtml(e.data.output),t.time=e.data.time,t.status=e.status,t.first_time=!1},function(t){console.log(t)})}}angular.module("app",["ngAnimate","AngularPrint"]),angular.module("app").config(["$interpolateProvider",function(t){t.startSymbol("[["),t.endSymbol("]]")}]),AppController.$inject=["$scope"],FrontController.$inject=["$scope","$timeout","$filter","$sce","$http"],UsersController.$inject=["$scope","$filter"],PacientsController.$inject=["$scope","$filter","$sce","$http"],FlashController.$inject=["$scope","$timeout"],ReviewController.$inject=["$scope","$filter","$timeout","$window"],BillController.$inject=["$scope","$filter","$timeout","$http","$sce","$window"],TestController.$inject=["$scope","$http","$filter","$interval","$timeout","$window","$sce"],angular.module("app").controller("AppController",AppController),angular.module("app").controller("FrontController",FrontController),angular.module("app").controller("UsersController",UsersController),angular.module("app").controller("PacientsController",PacientsController),angular.module("app").controller("FlashController",FlashController),angular.module("app").controller("ReviewController",ReviewController),angular.module("app").controller("BillController",BillController),angular.module("app").controller("TestController",TestController),$(document).ready(function(){$("#side-menu").metisMenu(),$(".navigation").click(function(t){$("nav").toggleClass("closed"),$(".wrap-content, #footer").toggleClass("compress")})});